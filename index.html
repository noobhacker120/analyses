<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Noob Hacker – Market Pattern Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
 margin:0;
 font-family:system-ui,-apple-system;
 background:radial-gradient(circle at top,#1b2a40,#050712 70%);
 color:#eaf1ff;
}
header{
 padding:14px;
 border-bottom:1px solid rgba(255,255,255,.08)
}
.title{
 font-size:18px;
 font-weight:600;
 margin-bottom:6px
}
.topbar{
 display:flex;
 flex-wrap:wrap;
 gap:10px;
 align-items:center;
 justify-content:space-between
}
select,button{
 background:#0d1a33;
 color:#fff;
 border:1px solid #2f4b8f;
 border-radius:8px;
 padding:6px 12px;
 cursor:pointer
}

.container{
 padding:14px;
 display:grid;
 gap:14px
}
.card{
 background:rgba(255,255,255,.06);
 border-radius:14px;
 padding:14px
}
h3{
 margin:0 0 10px;
 font-size:15px
}

.biasMain{
 font-size:20px;
 font-weight:700;
 text-align:center
}
.biasSub{
 font-size:12px;
 opacity:.7;
 text-align:center;
 margin-top:4px
}

.table{
 font-size:13px;
 display:grid;
 grid-template-columns:80px 1fr 1fr;
 gap:6px
}
.cell{
 background:rgba(0,0,0,.25);
 padding:6px;
 border-radius:6px;
 text-align:center
}

.good{color:#4dff88;font-weight:600}
.bad{color:#ff5252;font-weight:600}
.neutral{color:#ffc107;font-weight:600}

footer{
 text-align:center;
 font-size:12px;
 opacity:.6;
 margin:12px
}
</style>
</head>

<body>

<header>
 <div class="title">Noob Hacker – Market Pattern Dashboard</div>
 <div class="topbar">
  <select id="market">
   <option value="30">30 Second Market</option>
   <option value="60">1 Minute Market</option>
  </select>

  <button onclick="manualRefresh()">Manual Refresh</button>
  <div id="countdown">Remaining: --</div>
 </div>
</header>

<div class="container">

 <div class="card">
  <h3>Running Period</h3>
  <div class="biasMain" id="runningPeriod">--</div>
 </div>

 <div class="card">
  <h3>Big / Small Bias</h3>
  <div class="biasMain" id="bsBias">--</div>
  <div class="biasSub" id="bsFlip">Flip chance: --</div>
 </div>

 <div class="card">
  <h3>Color Bias</h3>
  <div class="biasMain" id="colorBias">--</div>
  <div class="biasSub" id="colorFlip">Flip chance: --</div>
 </div>

 <div class="card">
  <h3>Prediction vs Actual (Last 10)</h3>
  <div class="table" id="pvTable"></div>
 </div>

</div>

<footer>
Pattern-based observation only • Credit: Noob Hacker
</footer>

<script>
/* ================= CONFIG ================= */
const API_30="https://draw.ar-lottery01.com/WinGo/WinGo_30S/GetHistoryIssuePage.json";
const API_60="https://draw.ar-lottery01.com/WinGo/WinGo_1M/GetHistoryIssuePage.json";
const PROXY ="https://signal.chat31525.workers.dev/?url=";

/* ================= STATE ================= */
let timer,countTimer;
let memory = JSON.parse(localStorage.getItem("nh_memory") || "[]");

/* ================= CORE ================= */
function manualRefresh(){
 clearTimers();
 loadData();
}

function clearTimers(){
 clearTimeout(timer);
 clearInterval(countTimer);
}

async function loadData(){
 const sec=document.getElementById("market").value;
 const API=sec==="30"?API_30:API_60;

 try{
  const res=await fetch(PROXY+encodeURIComponent(API+"?pageSize=500&pageNo=1"));
  const json=await res.json();
  if(json.code!==0) return;
  analyse(json.data.list);
  scheduleNext(sec);
 }catch(e){}
}

function scheduleNext(sec){
 clearTimers();
 const base=sec*1000;
 const delay=base-(Date.now()%base)+200;
 startCountdown(delay);
 timer=setTimeout(loadData,delay);
}

function startCountdown(ms){
 let s=Math.floor(ms/1000);
 document.getElementById("countdown").textContent="Remaining: "+s+"s";
 countTimer=setInterval(()=>{
  s--;
  document.getElementById("countdown").textContent="Remaining: "+s+"s";
  if(s<=0) clearInterval(countTimer);
 },1000);
}

/* ================= ANALYSIS ================= */
function analyse(list){
 const running=(BigInt(list[0].issueNumber)+1n).toString();
 document.getElementById("runningPeriod").textContent=running;

 let bsSeq=[], colSeq=[];
 list.forEach(r=>{
  bsSeq.push(+r.number>=5?"Big":"Small");
  colSeq.push(r.color.includes("green")?"Green":"Red");
 });

 const bsBias=calcBias(bsSeq);
 const colBias=calcBias(colSeq);

 document.getElementById("bsBias").textContent=bsBias.label;
 document.getElementById("bsFlip").textContent="Flip chance: "+bsBias.flip+"%";

 document.getElementById("colorBias").textContent=colBias.label;
 document.getElementById("colorFlip").textContent="Flip chance: "+colBias.flip+"%";

 /* memory add (only once per period) */
 if(!memory.find(m=>m.period===running)){
  memory.unshift({
   period:running,
   predBS:bsBias.side,
   predCol:colBias.side,
   actBS:"WAIT",
   actCol:"WAIT"
  });
 }

 /* fill actual results */
 list.slice(0,10).forEach(r=>{
  const m=memory.find(x=>x.period===r.issueNumber);
  if(m){
   m.actBS=(+r.number>=5)?"Big":"Small";
   m.actCol=r.color.includes("green")?"Green":"Red";
  }
 });

 memory=memory.slice(0,10);
 localStorage.setItem("nh_memory",JSON.stringify(memory));

 renderTable();
}

/* ================= BIAS ENGINE ================= */
function calcBias(seq){
 const recent=seq.slice(0,20);
 let same=recent.filter(x=>x===recent[0]).length/recent.length;

 let flips=0;
 for(let i=1;i<recent.length;i++){
  if(recent[i]!==recent[i-1]) flips++;
 }
 flips=Math.round((flips/recent.length)*100);

 if(Math.abs(same-0.5)<0.08){
  return {label:"Neutral",side:"Neutral",flip:flips};
 }

 return same>0.5
  ?{label:recent[0]+" "+Math.round(same*100)+"%",side:recent[0],flip:flips}
  :{label:(recent[0]==="Big"?"Small":"Red")+" "+Math.round((1-same)*100)+"%",side:(recent[0]==="Big"?"Small":"Red"),flip:flips};
}

/* ================= TABLE ================= */
function renderTable(){
 const t=document.getElementById("pvTable");
 t.innerHTML=`
  <div class="cell"><b>Period</b></div>
  <div class="cell"><b>Big / Small</b></div>
  <div class="cell"><b>Color</b></div>
 `;

 memory.forEach(m=>{
  let cls="neutral";
  if(m.actBS!=="WAIT"){
   cls=(m.predBS===m.actBS && m.predCol===m.actCol)?"good":"bad";
  }

  t.innerHTML+=`
   <div class="cell">${m.period.slice(-5)}</div>
   <div class="cell ${cls}">${m.predBS} / ${m.actBS}</div>
   <div class="cell ${cls}">${m.predCol} / ${m.actCol}</div>
  `;
 });
}

/* ================= INIT ================= */
renderTable();   // show saved history on reload
loadData();
</script>

</body>
</html>
