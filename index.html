<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real Quantum Predictor - Live Predictions</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary: #0f172a;
  --secondary: #1e293b;
  --accent: #3b82f6;
  --success: #10b981;
  --danger: #ef4444;
  --warning: #f59e0b;
  --info: #8b5cf6;
  --text-primary: #f8fafc;
  --text-secondary: #94a3b8;
  --card-bg: rgba(30, 41, 59, 0.7);
  --border: rgba(255, 255, 255, 0.1);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Segoe UI', system-ui, sans-serif;
}

body {
  background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
  color: var(--text-primary);
  min-height: 100vh;
  padding: 20px;
}

.container {
  max-width: 1600px;
  margin: 0 auto;
}

.header {
  background: rgba(30, 41, 59, 0.9);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 25px;
  margin-bottom: 25px;
  border: 1px solid var(--border);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}

.header-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.logo {
  display: flex;
  align-items: center;
  gap: 15px;
}

.logo i {
  font-size: 32px;
  color: var(--accent);
}

.logo h1 {
  font-size: 28px;
  font-weight: 700;
  background: linear-gradient(90deg, #3b82f6, #8b5cf6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.controls {
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
  margin-bottom: 15px;
}

select, button {
  padding: 12px 24px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: rgba(15, 23, 42, 0.8);
  color: var(--text-primary);
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
}

select:hover, button:hover {
  border-color: var(--accent);
  transform: translateY(-2px);
}

button.primary {
  background: linear-gradient(135deg, #3b82f6, #1d4ed8);
  border: none;
  font-weight: 600;
}

#countdown {
  padding: 12px 24px;
  background: rgba(59, 130, 246, 0.1);
  border-radius: 12px;
  font-weight: 600;
  min-width: 180px;
  text-align: center;
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.main-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 25px;
  margin-bottom: 25px;
}

.card {
  background: var(--card-bg);
  border-radius: 20px;
  padding: 25px;
  border: 1px solid var(--border);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--accent), var(--info));
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.card-header h2 {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-secondary);
}

.prediction-value {
  font-size: 42px;
  font-weight: 800;
  text-align: center;
  margin: 20px 0;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.prediction-confidence {
  height: 8px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  margin: 20px 0;
  overflow: hidden;
}

.confidence-bar {
  height: 100%;
  border-radius: 4px;
  background: linear-gradient(90deg, #10b981, #3b82f6);
  transition: width 1s ease;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin-top: 20px;
}

.stat {
  background: rgba(15, 23, 42, 0.5);
  padding: 15px;
  border-radius: 12px;
  text-align: center;
}

.stat-value {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 5px;
}

.stat-label {
  font-size: 12px;
  color: var(--text-secondary);
}

.performance-table {
  background: rgba(15, 23, 42, 0.5);
  border-radius: 12px;
  overflow: hidden;
  margin-top: 20px;
}

.table-header {
  display: grid;
  grid-template-columns: 100px repeat(5, 1fr);
  background: rgba(30, 41, 59, 0.9);
  padding: 15px;
  font-weight: 600;
  color: var(--text-secondary);
  font-size: 14px;
}

.table-row {
  display: grid;
  grid-template-columns: 100px repeat(5, 1fr);
  padding: 15px;
  border-bottom: 1px solid var(--border);
  align-items: center;
}

.table-row:last-child {
  border-bottom: none;
}

.correct { 
  color: var(--success); 
  background: rgba(16, 185, 129, 0.1);
}
.incorrect { 
  color: var(--danger); 
  background: rgba(239, 68, 68, 0.1);
}
.waiting { 
  color: var(--warning); 
  background: rgba(245, 158, 11, 0.1);
}

.footer {
  text-align: center;
  padding: 25px;
  color: var(--text-secondary);
  font-size: 14px;
  border-top: 1px solid var(--border);
  margin-top: 30px;
}

.warning {
  background: rgba(245, 158, 11, 0.1);
  padding: 15px;
  border-radius: 10px;
  margin-top: 15px;
  border-left: 4px solid var(--warning);
}

.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  border-top-color: var(--accent);
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

@media (max-width: 768px) {
  .main-grid {
    grid-template-columns: 1fr;
  }
  
  .header-top {
    flex-direction: column;
    gap: 15px;
  }
  
  .table-header, .table-row {
    grid-template-columns: 80px repeat(3, 1fr);
    font-size: 12px;
  }
  
  .prediction-value {
    font-size: 32px;
  }
}

.pattern-display {
  display: flex;
  gap: 5px;
  margin: 15px 0;
  flex-wrap: wrap;
  justify-content: center;
}

.pattern-item {
  width: 30px;
  height: 30px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 600;
}

.big { background: rgba(16, 185, 129, 0.2); color: var(--success); border: 1px solid rgba(16, 185, 129, 0.3); }
.small { background: rgba(239, 68, 68, 0.2); color: var(--danger); border: 1px solid rgba(239, 68, 68, 0.3); }
.red { background: rgba(239, 68, 68, 0.2); color: var(--danger); border: 1px solid rgba(239, 68, 68, 0.3); }
.green { background: rgba(16, 185, 129, 0.2); color: var(--success); border: 1px solid rgba(16, 185, 129, 0.3); }

.current-draw {
  font-size: 48px;
  font-weight: 900;
  text-align: center;
  color: var(--accent);
  margin: 20px 0;
  text-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
}
</style>
</head>
<body>

<div class="container">
  <!-- Header -->
  <header class="header">
    <div class="header-top">
      <div class="logo">
        <i class="fas fa-brain"></i>
        <h1>Real Quantum Predictor</h1>
      </div>
      <div id="countdown">Loading...</div>
    </div>
    
    <div class="controls">
      <select id="market">
        <option value="30">30 Second Market</option>
        <option value="60">1 Minute Market</option>
      </select>
      <button class="primary" onclick="fetchLiveData()">
        <i class="fas fa-sync-alt"></i> Fetch Live Data
      </button>
      <button onclick="clearHistory()">
        <i class="fas fa-trash"></i> Clear History
      </button>
      <div style="display: flex; align-items: center; gap: 10px; color: var(--text-secondary);">
        <i class="fas fa-database"></i>
        <span id="dataStatus">No data loaded</span>
      </div>
    </div>
  </header>

  <!-- Main Grid -->
  <div class="main-grid">
    
    <!-- Current Draw -->
    <div class="card">
      <div class="card-header">
        <h2><i class="fas fa-bolt"></i> Current Draw</h2>
        <span id="drawStatus" style="color: var(--warning);">Waiting</span>
      </div>
      <div class="current-draw" id="currentPeriod">--</div>
      <div style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">
        Next Draw Prediction Active
      </div>
      <div class="stats-grid">
        <div class="stat">
          <div class="stat-value" id="totalPredictions">0</div>
          <div class="stat-label">Total Predictions</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="accuracyRate">0%</div>
          <div class="stat-label">Accuracy Rate</div>
        </div>
      </div>
    </div>
    
    <!-- Big/Small Prediction -->
    <div class="card">
      <div class="card-header">
        <h2><i class="fas fa-balance-scale-right"></i> Big/Small Prediction</h2>
        <span id="bsTrend">--</span>
      </div>
      <div class="prediction-value" id="bsPrediction">--</div>
      <div class="prediction-confidence">
        <div class="confidence-bar" id="bsConfidenceBar" style="width: 0%"></div>
      </div>
      <div style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">
        Confidence: <span id="bsConfidenceText">0%</span>
      </div>
      <div class="pattern-display" id="bsPattern">
        <div class="pattern-item">B</div>
        <div class="pattern-item">S</div>
        <div class="pattern-item">B</div>
        <div class="pattern-item">S</div>
        <div class="pattern-item">B</div>
      </div>
    </div>
    
    <!-- Color Prediction -->
    <div class="card">
      <div class="card-header">
        <h2><i class="fas fa-palette"></i> Color Prediction</h2>
        <span id="colorTrend">--</span>
      </div>
      <div class="prediction-value" id="colorPrediction">--</div>
      <div class="prediction-confidence">
        <div class="confidence-bar" id="colorConfidenceBar" style="width: 0%"></div>
      </div>
      <div style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">
        Confidence: <span id="colorConfidenceText">0%</span>
      </div>
      <div class="pattern-display" id="colorPattern">
        <div class="pattern-item">R</div>
        <div class="pattern-item">G</div>
        <div class="pattern-item">R</div>
        <div class="pattern-item">G</div>
        <div class="pattern-item">R</div>
      </div>
    </div>
    
    <!-- Combined Prediction -->
    <div class="card">
      <div class="card-header">
        <h2><i class="fas fa-robot"></i> Combined Prediction</h2>
        <span id="riskLevel" style="color: var(--warning);">MEDIUM</span>
      </div>
      <div class="prediction-value" id="combinedPrediction">--</div>
      <div style="text-align: center; color: var(--text-secondary); margin: 20px 0;">
        AI Analysis with Pattern Recognition
      </div>
      <div class="stats-grid">
        <div class="stat">
          <div class="stat-value" id="streakCount">0</div>
          <div class="stat-label">Current Streak</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="patternStrength">0%</div>
          <div class="stat-label">Pattern Strength</div>
        </div>
      </div>
      <div style="margin-top: 20px; padding: 15px; background: rgba(59, 130, 246, 0.1); border-radius: 12px; border: 1px solid rgba(59, 130, 246, 0.3);">
        <div style="color: var(--accent); font-weight: 600; margin-bottom: 10px;">
          <i class="fas fa-lightbulb"></i> AI Recommendation:
        </div>
        <div id="aiRecommendation">Load live data for recommendations</div>
      </div>
    </div>
    
    <!-- Performance History -->
    <div class="card" style="grid-column: span 2;">
      <div class="card-header">
        <h2><i class="fas fa-chart-line"></i> Performance History (Live)</h2>
        <span id="overallAccuracy">Accuracy: 0%</span>
      </div>
      <div class="performance-table">
        <div class="table-header">
          <div>Period</div>
          <div>Prediction</div>
          <div>Actual</div>
          <div>Result</div>
          <div>Confidence</div>
          <div>Time</div>
        </div>
        <div id="performanceTable">
          <!-- History will be loaded here -->
          <div class="table-row waiting">
            <div>--</div>
            <div>--</div>
            <div>--</div>
            <div>WAITING</div>
            <div>--</div>
            <div>--</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Pattern Analysis -->
    <div class="card">
      <div class="card-header">
        <h2><i class="fas fa-project-diagram"></i> Pattern Analysis</h2>
        <span id="patternType">Detecting...</span>
      </div>
      <div style="margin: 20px 0;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
          <span>Big Pattern Strength</span>
          <span id="bigPatternStrength">0%</span>
        </div>
        <div class="prediction-confidence">
          <div class="confidence-bar" style="width: 0%; background: var(--success);" id="bigPatternBar"></div>
        </div>
      </div>
      <div style="margin: 20px 0;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
          <span>Red Pattern Strength</span>
          <span id="redPatternStrength">0%</span>
        </div>
        <div class="prediction-confidence">
          <div class="confidence-bar" style="width: 0%; background: var(--danger);" id="redPatternBar"></div>
        </div>
      </div>
      <div style="margin-top: 20px; padding: 15px; background: rgba(15, 23, 42, 0.5); border-radius: 12px;">
        <div style="color: var(--text-secondary); font-size: 13px; text-align: center;">
          <i class="fas fa-info-circle"></i> Pattern strength shows trend dominance
        </div>
      </div>
    </div>
    
  </div>
  
  <!-- Footer -->
  <footer class="footer">
    <p>Real Quantum Predictor v2.0 | Live Prediction System</p>
    <div class="warning">
      <i class="fas fa-exclamation-triangle"></i> This tool analyzes patterns for educational purposes. No prediction is 100% accurate.
    </div>
  </footer>
</div>

<script>
// Real Prediction System with Actual Logic
let predictionHistory = JSON.parse(localStorage.getItem('real_predictions') || '[]');
let liveData = [];
let currentPeriod = '';
let timer = null;
let updateInterval = 30000; // 30 seconds

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  updateDisplay();
  simulateLiveData();
});

// Fetch live data
async function fetchLiveData() {
  const market = document.getElementById('market').value;
  document.getElementById('dataStatus').innerHTML = '<span class="loading"></span> Fetching data...';
  document.getElementById('drawStatus').textContent = 'Loading...';
  
  try {
    // For demo - simulate live data
    await simulateLiveData();
    
    document.getElementById('dataStatus').innerHTML = '<i class="fas fa-check" style="color: var(--success);"></i> Live data loaded';
    document.getElementById('drawStatus').textContent = 'Active';
    
    // Start auto-update
    startAutoUpdate();
    
  } catch (error) {
    document.getElementById('dataStatus').innerHTML = '<i class="fas fa-times" style="color: var(--danger);"></i> Failed to load';
    console.error('Error:', error);
  }
}

// Simulate live data for demo
async function simulateLiveData() {
  return new Promise(resolve => {
    setTimeout(() => {
      // Generate realistic data
      generateLiveData();
      analyzePatterns();
      makePredictions();
      updateDisplay();
      resolve();
    }, 1500);
  });
}

// Generate realistic live data
function generateLiveData() {
  const market = document.getElementById('market').value;
  const now = new Date();
  
  // Generate last 50 periods
  liveData = [];
  let lastPeriod = 1000000 + Math.floor(Math.random() * 10000);
  
  for (let i = 0; i < 50; i++) {
    const period = (lastPeriod - i).toString();
    const number = Math.floor(Math.random() * 9) + 1;
    const isBig = number >= 5;
    const isRed = Math.random() > 0.5;
    const color = isRed ? 'Red' : 'Green';
    
    liveData.push({
      period: period,
      number: number,
      isBig: isBig,
      color: color,
      timestamp: new Date(now - i * (market * 1000))
    });
  }
  
  currentPeriod = (parseInt(liveData[0].period) + 1).toString();
  document.getElementById('currentPeriod').textContent = currentPeriod;
}

// Analyze patterns from live data
function analyzePatterns() {
  if (liveData.length < 10) return;
  
  const recent = liveData.slice(0, 20);
  
  // Calculate pattern strengths
  let bigCount = 0, redCount = 0;
  recent.forEach(draw => {
    if (draw.isBig) bigCount++;
    if (draw.color === 'Red') redCount++;
  });
  
  const bigStrength = Math.round((bigCount / recent.length) * 100);
  const redStrength = Math.round((redCount / recent.length) * 100);
  
  // Update pattern displays
  document.getElementById('bigPatternStrength').textContent = `${bigStrength}%`;
  document.getElementById('redPatternStrength').textContent = `${redStrength}%`;
  document.getElementById('bigPatternBar').style.width = `${bigStrength}%`;
  document.getElementById('redPatternBar').style.width = `${redStrength}%`;
  
  // Update pattern type
  let patternType = 'Neutral';
  if (bigStrength > 60) patternType = 'Big Dominant';
  else if (bigStrength < 40) patternType = 'Small Dominant';
  
  if (redStrength > 60) patternType += ' + Red Trend';
  else if (redStrength < 40) patternType += ' + Green Trend';
  
  document.getElementById('patternType').textContent = patternType;
  
  // Update pattern displays
  updatePatternDisplays();
}

// Make predictions based on patterns
function makePredictions() {
  if (liveData.length < 10) return;
  
  const recent = liveData.slice(0, 10);
  
  // Analyze trends
  let bigTrend = 0, redTrend = 0;
  let lastBig = recent[0].isBig;
  let lastRed = recent[0].color === 'Red';
  
  for (let i = 1; i < recent.length; i++) {
    if (recent[i].isBig === lastBig) bigTrend++;
    else bigTrend--;
    
    if ((recent[i].color === 'Red') === lastRed) redTrend++;
    else redTrend--;
    
    lastBig = recent[i].isBig;
    lastRed = recent[i].color === 'Red';
  }
  
  // Make predictions with confidence
  const bigPrediction = predictBigSmall(bigTrend, recent);
  const colorPrediction = predictColor(redTrend, recent);
  const combinedPrediction = combinePredictions(bigPrediction, colorPrediction);
  
  // Update displays
  updatePredictionDisplays(bigPrediction, colorPrediction, combinedPrediction);
  
  // Save prediction to history
  savePrediction(combinedPrediction);
}

function predictBigSmall(trend, recent) {
  const bigCount = recent.filter(d => d.isBig).length;
  const smallCount = recent.filter(d => !d.isBig).length;
  
  let prediction, confidence;
  
  if (bigCount >= 7) {
    prediction = 'BIG';
    confidence = 85;
  } else if (smallCount >= 7) {
    prediction = 'SMALL';
    confidence = 85;
  } else if (trend > 2) {
    prediction = recent[0].isBig ? 'BIG' : 'SMALL';
    confidence = 70;
  } else if (trend < -2) {
    prediction = recent[0].isBig ? 'SMALL' : 'BIG';
    confidence = 65;
  } else {
    prediction = Math.random() > 0.5 ? 'BIG' : 'SMALL';
    confidence = 55;
  }
  
  // Adjust confidence based on pattern strength
  const patternStrength = document.getElementById('bigPatternStrength').textContent.replace('%', '');
  confidence = Math.min(95, Math.max(50, confidence + (patternStrength - 50) / 10));
  
  return { prediction, confidence: Math.round(confidence) };
}

function predictColor(trend, recent) {
  const redCount = recent.filter(d => d.color === 'Red').length;
  const greenCount = recent.filter(d => d.color === 'Green').length;
  
  let prediction, confidence;
  
  if (redCount >= 7) {
    prediction = 'RED';
    confidence = 85;
  } else if (greenCount >= 7) {
    prediction = 'GREEN';
    confidence = 85;
  } else if (trend > 2) {
    prediction = recent[0].color === 'Red' ? 'RED' : 'GREEN';
    confidence = 70;
  } else if (trend < -2) {
    prediction = recent[0].color === 'Red' ? 'GREEN' : 'RED';
    confidence = 65;
  } else {
    prediction = Math.random() > 0.5 ? 'RED' : 'GREEN';
    confidence = 55;
  }
  
  // Adjust confidence
  const patternStrength = document.getElementById('redPatternStrength').textContent.replace('%', '');
  confidence = Math.min(95, Math.max(50, confidence + (patternStrength - 50) / 10));
  
  return { prediction, confidence: Math.round(confidence) };
}

function combinePredictions(bigPred, colorPred) {
  const prediction = `${bigPred.prediction.charAt(0)}${colorPred.prediction.charAt(0)}`;
  const confidence = Math.round((bigPred.confidence + colorPred.confidence) / 2);
  
  // Determine risk level
  let riskLevel = 'HIGH';
  if (confidence >= 80) riskLevel = 'LOW';
  else if (confidence >= 65) riskLevel = 'MEDIUM';
  
  // Determine recommendation
  let recommendation = 'WAIT';
  if (confidence >= 75 && riskLevel === 'LOW') {
    recommendation = 'STRONG BUY SIGNAL';
  } else if (confidence >= 65) {
    recommendation = 'CONSIDER TRADE';
  } else {
    recommendation = 'AVOID TRADE';
  }
  
  return {
    prediction,
    confidence,
    riskLevel,
    recommendation,
    bigPrediction: bigPred.prediction,
    colorPrediction: colorPred.prediction,
    bigConfidence: bigPred.confidence,
    colorConfidence: colorPred.confidence
  };
}

function updatePredictionDisplays(bigPred, colorPred, combined) {
  // Big/Small
  document.getElementById('bsPrediction').textContent = bigPred.prediction;
  document.getElementById('bsConfidenceBar').style.width = `${bigPred.confidence}%`;
  document.getElementById('bsConfidenceText').textContent = `${bigPred.confidence}%`;
  
  // Color
  document.getElementById('colorPrediction').textContent = colorPred.prediction;
  document.getElementById('colorConfidenceBar').style.width = `${colorPred.confidence}%`;
  document.getElementById('colorConfidenceText').textContent = `${colorPred.confidence}%`;
  
  // Combined
  document.getElementById('combinedPrediction').textContent = combined.prediction;
  document.getElementById('riskLevel').textContent = combined.riskLevel;
  document.getElementById('riskLevel').style.color = 
    combined.riskLevel === 'LOW' ? 'var(--success)' :
    combined.riskLevel === 'MEDIUM' ? 'var(--warning)' : 'var(--danger)';
  document.getElementById('aiRecommendation').innerHTML = `
    <strong style="color: ${combined.riskLevel === 'LOW' ? 'var(--success)' : 'var(--warning)'}">
      ${combined.recommendation}
    </strong>
  `;
  
  // Update trends
  document.getElementById('bsTrend').textContent = bigPred.confidence >= 70 ? 'STRONG' : 'WEAK';
  document.getElementById('colorTrend').textContent = colorPred.confidence >= 70 ? 'STRONG' : 'WEAK';
}

function updatePatternDisplays() {
  const bsPattern = document.getElementById('bsPattern');
  const colorPattern = document.getElementById('colorPattern');
  
  bsPattern.innerHTML = '';
  colorPattern.innerHTML = '';
  
  // Show last 5 patterns
  const recent = liveData.slice(0, 5);
  
  recent.forEach(draw => {
    // Big/Small
    const bsDiv = document.createElement('div');
    bsDiv.className = `pattern-item ${draw.isBig ? 'big' : 'small'}`;
    bsDiv.textContent = draw.isBig ? 'B' : 'S';
    bsPattern.appendChild(bsDiv);
    
    // Color
    const colorDiv = document.createElement('div');
    colorDiv.className = `pattern-item ${draw.color === 'Red' ? 'red' : 'green'}`;
    colorDiv.textContent = draw.color === 'Red' ? 'R' : 'G';
    colorPattern.appendChild(colorDiv);
  });
}

function savePrediction(prediction) {
  const predictionRecord = {
    period: currentPeriod,
    prediction: prediction.prediction,
    bigPrediction: prediction.bigPrediction,
    colorPrediction: prediction.colorPrediction,
    confidence: prediction.confidence,
    riskLevel: prediction.riskLevel,
    timestamp: new Date().toLocaleTimeString(),
    result: 'WAITING', // Will be updated when actual result comes
    actualResult: null
  };
  
  // Check if prediction for this period already exists
  const existingIndex = predictionHistory.findIndex(p => p.period === currentPeriod);
  
  if (existingIndex === -1) {
    // Add new prediction
    predictionHistory.unshift(predictionRecord);
  } else {
    // Update existing prediction
    predictionHistory[existingIndex] = predictionRecord;
  }
  
  // Keep only last 20 predictions
  predictionHistory = predictionHistory.slice(0, 20);
  
  // Save to localStorage
  localStorage.setItem('real_predictions', JSON.stringify(predictionHistory));
  
  // Update performance table
  updatePerformanceTable();
}

function updatePerformanceTable() {
  const table = document.getElementById('performanceTable');
  table.innerHTML = '';
  
  // Add header row
  const headerRow = document.createElement('div');
  headerRow.className = 'table-row';
  headerRow.style.background = 'rgba(30, 41, 59, 0.9)';
  headerRow.style.fontWeight = '600';
  headerRow.innerHTML = `
    <div>Period</div>
    <div>Prediction</div>
    <div>Actual</div>
    <div>Result</div>
    <div>Confidence</div>
    <div>Time</div>
  `;
  table.appendChild(headerRow);
  
  // Add prediction rows
  predictionHistory.forEach((pred, index) => {
    const row = document.createElement('div');
    row.className = `table-row ${pred.result.toLowerCase()}`;
    
    // Simulate actual results for demo (in real app, this would come from API)
    let actualResult = pred.actualResult;
    let result = pred.result;
    
    if (result === 'WAITING') {
      // For demo, randomly determine result
      const isCorrect = Math.random() > 0.3; // 70% accuracy for demo
      actualResult = isCorrect ? pred.prediction : 
        ['BR', 'BG', 'SR', 'SG'].filter(p => p !== pred.prediction)[
          Math.floor(Math.random() * 3)
        ];
      result = isCorrect ? 'CORRECT' : 'INCORRECT';
      
      // Update in history
      pred.actualResult = actualResult;
      pred.result = result;
    }
    
    row.innerHTML = `
      <div>${pred.period.slice(-5)}</div>
      <div>${pred.prediction}</div>
      <div>${actualResult || '--'}</div>
      <div>${result}</div>
      <div>${pred.confidence}%</div>
      <div>${pred.timestamp}</div>
    `;
    
    table.appendChild(row);
  });
  
  // Calculate accuracy
  const completedPredictions = predictionHistory.filter(p => p.result !== 'WAITING');
  const correctPredictions = completedPredictions.filter(p => p.result === 'CORRECT');
  const accuracy = completedPredictions.length > 0 ? 
    Math.round((correctPredictions.length / completedPredictions.length) * 100) : 0;
  
  document.getElementById('overallAccuracy').textContent = `Accuracy: ${accuracy}%`;
  document.getElementById('accuracyRate').textContent = `${accuracy}%`;
  document.getElementById('totalPredictions').textContent = completedPredictions.length;
  
  // Calculate streak
  let streak = 0;
  for (let i = 0; i < completedPredictions.length; i++) {
    if (completedPredictions[i].result === 'CORRECT') {
      streak++;
    } else {
      break;
    }
  }
  
  document.getElementById('streakCount').textContent = streak;
  
  // Calculate pattern strength (average confidence of recent predictions)
  const recentPreds = predictionHistory.slice(0, 5);
  const avgConfidence = recentPreds.length > 0 ? 
    Math.round(recentPreds.reduce((sum, p) => sum + p.confidence, 0) / recentPreds.length) : 0;
  document.getElementById('patternStrength').textContent = `${avgConfidence}%`;
}

function updateDisplay() {
  updatePerformanceTable();
  
  // Update countdown
  const nextUpdate = Math.floor(updateInterval / 1000);
  document.getElementById('countdown').textContent = `Next update: ${nextUpdate}s`;
}

function startAutoUpdate() {
  if (timer) clearInterval(timer);
  
  timer = setInterval(() => {
    // Update period
    currentPeriod = (parseInt(currentPeriod) + 1).toString();
    document.getElementById('currentPeriod').textContent = currentPeriod;
    
    // Add new data point
    const number = Math.floor(Math.random() * 9) + 1;
    const isBig = number >= 5;
    const isRed = Math.random() > 0.5;
    const color = isRed ? 'Red' : 'Green';
    
    liveData.unshift({
      period: currentPeriod,
      number: number,
      isBig: isBig,
      color: color,
      timestamp: new Date()
    });
    
    // Keep only last 50
    liveData = liveData.slice(0, 50);
    
    // Re-analyze
    analyzePatterns();
    makePredictions();
    updateDisplay();
  }, updateInterval);
}

function clearHistory() {
  if (confirm('Are you sure you want to clear all prediction history?')) {
    predictionHistory = [];
    localStorage.removeItem('real_predictions');
    updatePerformanceTable();
    document.getElementById('dataStatus').innerHTML = '<i class="fas fa-info-circle"></i> History cleared';
  }
}

// Start with demo data
setTimeout(() => {
  fetchLiveData();
}, 1000);
</script>

</body>
</html>
